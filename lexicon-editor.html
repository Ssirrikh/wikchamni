<!DOCTYPE html>
<html lang='en' xml:lang='en'>
<head>
	<meta charset = 'utf-8'>
	<title>Lexical</title>
    <meta name='robots' content='index, follow'>
    <meta name='description' content="Work on your language's lexicon in a clean, modern interface with support for automated checks and formatting.">
	<meta name='viewport' content='width=device-width, initial-scale=1'>
    <style>
		:root {
            --text-light: #f5f5f5;
            --text-dark: #323440;
            --text-subtitle: #636570;
            --bg-white: #ffffff;
            --bg-light: #f5f5f5;
            --bg-highlight: #65b9ff;
            --bg-medium: #3b454a;
            --bg-dark: #1a282f;
            --border-light-unfocused: #484f58;
            --border-light: #e2e4e5;
            --border-medium: #cfcfcf;
            --text-error: #dc0019;

            /* from github.com */
            --border-highlight: #8c93fb;
            --border-highlight: #d8dbff;
            /* --bg-light: #eae9f5; */
            --bg-dark: #070942;
            /* --border-highlight: #fff; */

            --fluid-font-size: max(2.5vh, calc(1rem + 1.0vw));
		}

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Times New Roman';
        }
        body {
            color: var(--text-dark);
            background-color: var(--bg-dark);
            font-size: var(--fluid-font-size);
        }
        button {
            color: var(--text-dark);
            background-color: transparent;
            border: none;
            outline: none;
        }
        h1, h2, h3, h4, h5, h6 {
            font-size: 1em;
            font-weight: normal;
        }

        /* label {
            font-size: 0.5em;
        } */
        input {
            font-size: 1em;
        }
        select {
            padding: 0.2em 0.5em;
        }



        /**** FLEXBOX UTILITY ****/

        .flex-sep {
            width: 0;
            flex-grow: 1;
        }
        .flex-row {
            display: flex;
            flex-direction: row !important;
            align-items: start;
        }
        .flex-col {
            display: flex;
            flex-direction: column !important;
        }
        .flex-adapt {
            /* column on mobile, row on desktop */
            display: flex;
            flex-direction: column !important;
            align-items: center;
        }
        .flex-adapt-reverse {
            /* row on mobile, column on desktop */
            display: flex;
            flex-direction: row !important;
            align-items: normal;
            justify-content: center;
        }
        .flex-centered {
            align-items: center;
            justify-content: center;
        }



        /**** SITE LAYOUT ****/

        #main-floating {
            background-color: var(--bg-light);
            border: 1px solid var(--border-highlight);
            border-radius: 0.3em;
            transform: translate(-50%,-50%);

            position: absolute;
            top: 50%;
            left: 50%;
            width: min(20em, 90vw);

            padding: 0.5em;
        }
        #lang-data {
            /*  */
        }
        #lang-stats {
            font-size: 0.5em;
        }
        #lang-data > label {
            margin-top: 0.5em;
            margin-bottom: 0.1em;
        }
        #lang-data > input {
            padding: 0.2em 0.5em;
        }
        .separator-line {
            background-color: var(--text-subtitle);
            width: 100%;
            height: 1px;
            margin: 0.5em 0;
        }
        .input-subtitle {
            color: var(--text-subtitle);
            font-size: 0.4em;
        }

        /* word forms */
        #forms-wrapper {
            /* font-size: 0.5em; */
        }
        .forms-catg {
            font-size: 0.7em;
        }
        .forms-formcount {
            color: var(--text-subtitle);
        }
        .forms-formnames-wrapper {
            font-size: 0.5em;
            gap: 0.5em;
        }
        .forms-formname {
            background-color: var(--bg-white);
            border: 1px solid var(--text-subtitle);
            border-radius: 0.5em;

            padding: 0.2em 0.5em;
        }
        .forms-unattested {
            color: var(--text-subtitle);
            border: 1px solid var(--border-light);
        }
        .no-forms {
            color: var(--text-subtitle);
            font-size: 0.5em;
        }


        /* reuseable components */
        .subtitle {
            color: var(--text-subtitle);
        }
        .subtitle-small {
            color: var(--text-subtitle);
            font-size: 0.8em;
        }

        /* from chill: text is #fff, border is #ccc, inactive text is opacity .4 */

        .toggle-switch {
            /* color: white; */
            background: linear-gradient(180deg, #fff2 0%, #9992 100%);
            border: 1px solid var(--border-light);
            border-radius: 0.2em;
            /* padding: 0.2em; */
        }
        .toggle-switch > button {
            font-size: 1em;
        }



        /* word data entry */
        #main {
            /* border: 1px solid red; */
            width: 100vw;
            height: 100vh;
            align-items: stretch;
        }
        #panel-lexicon {
            /* border: 1px solid blue; */
            background-color: var(--bg-white);
            width: 30%;
            width: 14em;
            font-size: 0.8em;
            flex-shrink: 0;
        }
        #panel-entry-editor {
            /* border: 1px solid yellow; */
            background-color: var(--bg-light);
            border-left: 1px solid var(--border-medium);
            padding: 0.3em;
            font-size: 0.8em;
            gap: 0.3em;
            flex-grow: 1;
        }

        /* lexicon header */
        #lexicon-header {
            color: var(--text-light);
            background-color: var(--bg-dark);
        }
        #lexicon-header > .flex-row {
            padding: 0.2em;
            align-items: center;
            justify-content: space-between;
        }
        #lexicon-header h2 {
            color: var(--border-highlight);
        }
        #lexicon-header .toggle-switch {
            /* border: 1px solid red; */
        }
        #lexicon-header .toggle-switch > button {
            color: var(--text-subtitle);
            border-radius: 1em;
            width: 3em;
        }
        #lexicon-header .toggle-switch > .toggle-selected {
            /* background: linear-gradient(180deg, #fff2 0%, #9992 100%); */
            /* border: 1px solid var(--text-light); */
            color: var(--text-light);
        }
        #lexicon-header > p {
            color: var(--bg-medium);
        }
        /* lexicon filters */
        #lexicon-filters {
            background-color: var(--bg-light);
            border-bottom: 1px solid var(--border-medium);
            font-size: 0.8em
        }
        #lexicon-search-wrapper {
            padding: 0.3em;
            gap: 0.3em;
            align-items: center;
        }
        #lexicon-search-wrapper > input {
            width: 100%;
            font-size: 1em;
        }
        #lexicon-search-from {
            border: 1px solid var(--border-medium);
            border-radius: 0.2em;
            position: relative;
            width: fit-content;
            padding: 0 0.2em;
            font-size: 0.8em;
            justify-content: center;
        }
        #lexicon-search-from > button {
            color: var(--text-subtitle);
            width: 4em;
            font-size: 1em;
        }
        #lexicon-search-from > .option-selected {
            color: var(--text-dark);
        }
        #lexicon-search-from-selector {
            background-color: var(--bg-dark);
            background-color: var(--bg-highlight);
            transform: translate(-50%,0.25em);
            position: absolute;
            width: 3.5em;
            height: 0.1em;
            bottom: 0;
            left: 50%;
            transition: 0.2s ease;
        }
        .selector-left {
            left: calc(50% - 4em) !important;
        }
        .selector-right {
            left: calc(50% + 4em) !important;
        }
        #catg-filter-wrapper {
            padding: 0.5em;
        }
        #lexicon-filter-catg-wrapper {
            padding: 0.3em;
            gap: 0.3em;
        }



        /* entry editor */
        #entry-data-basic > label {
            margin-top: 0.5em;
            margin-bottom: 0.1em;
        }
        #entry-catg {
            width: min(90%, 10em);
            /* padding: 0.2em 0.5em; */
        }



        /**** MEDIA QUERIES ****/

        /* mobile-first styling for better load times on less-powerful devices */
        @media (max-aspect-ratio: 5/4) { /* mobile mode */
            /*  */
        }
		@media (min-aspect-ratio: 5/4) { /* desktop mode */
            :root {
                /*  */
            }
            .flex-adapt {
                display: flex;
                flex-direction: row !important;
                align-items: normal;
                justify-content: center;
            }
            .flex-adapt-reverse {
                display: flex;
                flex-direction: column !important;
                align-items: center;
            }
        }
		
	</style>
</head>
<body>

<!-- <div id='main-floating'>
    <h1>Language Data</h1>
    <div class='separator-line'></div>
    <div id='lang-data' class='flex-col'>
        <label for='lang-name'>Language Name</label>
        <input id='lang-name' type='text'>
        <label for='lang-abbr'>Abbreviation</label>
        <input id='lang-abbr' type='text'>
        <p id='desc-abbr' class='input-subtitle'>2-3 letter abbreviation of language name, for example "eng" for English.</p>
        <label for='lang-alphabet'>Alphabet</label>
        <input id='lang-alphabet' type='text' value='a b c d e f g h i j k l m n o p q r s t u v w x y z'>
        <p id='desc-alphabet' class='input-subtitle'>Every character in your language's alphabet, separated by spaces. The order will determine how words in your lexicon are alphabetized.</p>
    </div>
    <div class='separator-line'></div>
    <div class='flex-col'>
        <h2>Parts of Speech & Wordforms</h2>
        <div id='forms-wrapper' class='flex-col'>
            <div class='flex-col'>
                <p class='forms-catg'>Noun <span class='forms-formcount'>(4 wordforms)</span></p>
                <div class='flex-row forms-formnames-wrapper'>
                    <div class='forms-formname'>Subject</div>
                    <div class='forms-formname'>Object</div>
                    <div class='forms-formname'>Owner</div>
                    <div class='forms-formname'>Owned</div>
                    <div class='forms-formname forms-unattested'>Locative</div>
                </div>
            </div>
            <p class='no-forms'>[no parts of speech have been defined]</p>
        </div>
    </div>
    <div class='separator-line'></div>
    <div id='lang-stats' class='flex-col'>
        <p>Entries: 0</p>
        <p>L1 Words: 0</p>
        <p>L2 Words: 0</p>
        <p>Sentences: 0</p>
        <p>By part of speech:</p>
        <p> Nouns: 0</p>
        <p> Verbs: 0</p>
        <p> Adjectives: 0</p>
    </div>
</div> -->

<div id='main' class='flex-row'>
    <div id='panel-lexicon' class='flex-col'>
        <div id='lexicon-header' class='flex-col'>
            <div class='flex-row'>
                <h2>Sort lexicon by:</h2>
                <div class='flex-row toggle-switch'>
                    <button>L1</button>
                    <button class='toggle-selected'>L2</button>
                </div>
            </div>
            <!-- <p class='subtitle-small'>L1 is the finder language (usually English) used to organize the database. L2 is the target language which data is being collected for.</p> -->
        </div>
        <div id='lexicon-filters' class='flex-col'>
            <div id='lexicon-search-wrapper' class='flex-col'>
                <div id='lexicon-search-from' class='flex-row'>
                    <div id='lexicon-search-from-selector' class='selector-left'></div>
                    <button class='option-selected'>Begins</button>
                    <button>Contains</button>
                    <button>Ends</button>
                </div>
                <input type='text' placeholder='Search...'>
            </div>
            <div id='lexicon-filter-catg-wrapper' class='flex-col'>
                <p>Filter by part of speech:</p>
                <div id='catg-filter-wrapper' class='flex-row'>
                    <button class='toggle-enabler'>Noun</button>
                    <button class='toggle-enabler'>Verb</button>
                    <button class='toggle-enabler toggle-enabler-disabled'>Adjective</button>
                </div>
            </div>
        </div>
        <div id='lexicon-entries' class='flex-col'>
            <div>Entry 1</div>
            <div>Entry 2</div>
            <div>Entry 3</div>
            <div>Entry 4</div>
            <div>Entry 5</div>
        </div>
    </div>
    <div id='panel-entry-editor' class='flex-col'>
        <!-- basic info -->
        <div id='entry-data-basic' class='flex-col'>
            <label for='entry-L1'>English Word(s)</label>
            <input id='entry-L1' type='text'>
            <p id='desc-entry-L1' class='subtitle-small'>Synonyms can be added using semicolons, ie "dash; run; sprint".</p>
            <label for='entry-catg'>Part of Speech:</label>
            <select id='entry-catg'>
                <option value='n'>Noun</option>
                <option value='v'>Verb</option>
                <option value='adj'>Adjective</option>
                <option value='+'>[+ add new]</option>
            </select>
        </div>
        <div class='separator-line'></div>
        <!-- L2 forms -->
        <h3>Wikchamni Forms</h3>
        <div class='flex-row entry-data-L2'>
            <select>
                <option value='subject'>Subject</option>
                <option value='object'>Object</option>
                <option value='locative'>Locative</option>
                <option value='+'>[+ add new]</option>
            </select>
            <input type='text'>
        </div>
    </div>
</div>



<script type='text/javascript'>

    //// REFS ////

    // https://subscriptions.hollywoodreporter.com/site/thr-subscribe



    //// WAVE 3 ////

    // 7.0 hrs: design research, color palette, layout
    // 0.5 hrs: custom alphabetization research
    // 2.0 hrs: add Language object and JSON data format, misc bugfixes
    // 1.5 hrs: data format and editor design
    // 4.5 hrs: lexicon design
    // 2.0 hrs: entry editor design



    //// dictionary.js ////

    const SYNONYM_SPLITTER = '; ';
	const ALPHABET_SPLITTER = ' ';

    function alphabetizeUnicode (a,b) {
		// alphabetization defaults to case-insensative unicode character order
		a = a.toLowerCase();
		b = b.toLowerCase();
		if (a > b) return 1;
		if (a < b) return -1;
		return 0;
	}

    class Language {
		constructor (name = 'New Language', abbreviation = 'lng', alphabet = '') {
			this.name = name;
			this.abbr = abbreviation;
			this.alphabet = alphabet.split(ALPHABET_SPLITTER);
			this.alphabetize = alphabetizeUnicode;
			this.usesForms = false;
			this.forms = {};
		}
        get abbreviation () { return this.abbr; }
		setCatgForms (catg, forms) {
			this.usesForms = true;
			for (let form of this.forms[catg]) {
				if (form) {
					console.warn(`Overwriting form names ${this.forms[catg]} -> ${forms}.`);
					break;
				}
			}
			this.forms[catg] = [];
			for (let form in forms) {
				this.forms[catg].push(form);
			}
		}
		addForm (catg, formNum, formName) {
			this.usesForms = true;
			if (!this.forms[catg]) {
				this.forms.catg = [];
			}
			if (this.forms[catg][formNum] && this.forms[catg][formNum] != formName) {
				console.warn(`Replacing ${catg} form ${formNum} "${this.forms[catg][formNum]}" with "${formName}" (${this.name}).`);
			}
			this.forms[catg][formNum] = formName;
		}
		getForm (catg, formNum) {
			if (this.forms[catg] && this.forms[catg][formNum]) {
				return this.forms[catg][formNum];
			} else {
				// return `Form ${formNum}`;
				return '';
			}
		}
		hasForm (catg, formNum) {
			return this.forms[catg] && this.forms[catg][formNum];
		}
        toJSON () {
            let o = {
                name : this.name ?? "",
                abbr : this.abbr ?? "",
                alphabet : this.alphabet.join(ALPHABET_SPLITTER),
                usesForms : this.usesForms,
                forms : {}
            };
            for (let catg in this.forms) {
                o.forms[catg] = [];
                for (let formNum = 0; formNum < this.forms[catg].length; formNum++) {
                    o.forms[catg][formNum] = this.forms[catg][formNum];
                }
            }
            return JSON.stringify(o);
        }
        fromJSON (s) {
            let o = JSON.parse(s);
            this.name = o.name ?? "";
            this.abbr = o.abbr ?? "";
            this.alphabet = (o.alphabet) ? o.alphabet.split(ALPHABET_SPLITTER) : [];
            this.usesForms = o.usesForms ?? (Object.keys(o.forms).length > 0);
            this.forms = {};
            for (let catg in o.forms) {
                this.forms[catg] = [];
                for (let formNum = 0; formNum < o.forms[catg].length; formNum++) {
                    this.forms[catg][formNum] = o.forms[catg][formNum];
                }
            }
        }
	}

    //// site functionality ////

    function loadLanguageData (L) {
        document.getElementById('lang-name').value = L.name;
        document.getElementById('lang-abbr').value = L.abbr;
        document.getElementById('lang-alphabet').value = L.alphabet.join(ALPHABET_SPLITTER);
    }

    let L1_eng = new Language('English', 'eng', `a b c d e f g h i j k l m n o p q r s t u v w x y z`);
    let L2_chk = new Language('Chukchansi', 'chk', `a b c d e f g h i j k l m n o p r s t u w x y ' ʔ`);
    let L1str = L1_eng.toJSON();
    let L2str = L2_chk.toJSON();
    console.log(L1str);
    console.log(L2str);

    let L2_wik = new Language();
    L2_wik.fromJSON(`{"name":"Wikchamni","abbr":"wik","alphabet":"a c č e f h i k l m n ŋ o p s š t ṭ u w x y ʔ","usesForms":true,"forms":{}}`);
    console.log(L2_wik);
    loadLanguageData(L2_wik);

    // // demo animated selection indicator
    // document.getElementById('lexicon-search-from-selector').classList.remove('selector-left');

</script>

</body>
</html>